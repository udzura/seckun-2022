# 演習1

※ 大学の授業なので、細かいところはいい感じに補完するか、いい感じの質問をしてご対応ください。

## 1.1 コンテナの理解の前に、プロセスを理解しよう。

* Rubyをインストールしてください。バージョンはなんでもいいので、OSのパッケージのもので構いません。

* Rubyをインストールしたら、Rubyから以下のシステムコールを使う方法を調査しましょう。

```
* fork(2)
* exec(2)
* wait(2)
* exit(2)
```

* 上記を調べたら、それぞれのAPI（メソッド）を用いてRubyの下に一つプロセスを作り、bashを立ち上げるプログラムを作成してください。

* 上記プログラムを実行したときのプロセスツリーの様子を観察しましょう。

## 1.2. 「自作プロセス」を自作コンテナにしてみよう。

* root filesystemを作りましょう。debootstrap、もしくはdocker exportなどを用います。以下のコマンドを実行します（稀に最後に失敗しますが、今回はfsが欲しいだけなのでそのまま進んでOKです）。

```
mkdir ~/myroot
sudo debootstrap bullseye ~/myroot http://ftp.us.debian.org/debian
```

* chrootコマンドについて調べて、上のrootファイルシステムに「入って」ください。下記コマンドから以下の出力を得られたら成功です。また、ホストのUbuntuと違う状態であることを示すコマンドをいくつか考えてみてください。

```
root@seckun-vm:/# cat /etc/issue
Debian GNU/Linux 11 \n \l

```

* 先ほどの「自作プロセス作成プログラム」の中で、以下のメソッドを利用して、chrootした状態でbashを起動してください。どのタイミングで実行すべきか調査し、考えてみましょう。

```
Dir.chdir(...)
Dir.chroot(...)
```
